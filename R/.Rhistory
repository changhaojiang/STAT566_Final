knitr::opts_chunk$set(echo = TRUE)
diabetes %>% filter(score > 0.4112) %>% summarise(n=n())
library(data.table)
library(randomForest)
library(dplyr)
data_dir <- "~/Documents/STAT566/Project"
balanced_diabetes <- fread(file.path(data_dir, "diabetes_binary_5050split_health_indicators_BRFSS2015.csv"))
diabetes <- fread(file.path(data_dir,"diabetes_binary_health_indicators_BRFSS2015.csv"))
dim(balanced_diabetes)
balanced_diabetes[1:3,]
dim(diabetes)
diabetes[1:3,]
set.seed(1)
fit.forest= randomForest(Diabetes_binary ~ HvyAlcoholConsump + Smoker +
PhysActivity + Fruits + Veggies,
data = balanced_diabetes, na.action = na.roughfix)
importance(fit.forest)
w1 = importance(fit.forest)[1]/sum(importance(fit.forest))
w2 = importance(fit.forest)[2]/sum(importance(fit.forest))
w3 = importance(fit.forest)[3]/sum(importance(fit.forest))
w4 = importance(fit.forest)[4]/sum(importance(fit.forest))
w5 = importance(fit.forest)[5]/sum(importance(fit.forest))
score = -diabetes$HvyAlcoholConsump * w1 - diabetes$Smoker * w2 +
diabetes$PhysActivity * w3 + diabetes$Fruits * w4 + diabetes$Veggies * w5
summary(score)
hist(score)
score
diabetes %>% filter(score > 0.4112) %>% summarise(n=n())
diabetes %>% filter(score <= 0.4112) %>% summarise(n=n())
diabetes$score <- score
sum(diabetes[diabetes$score<=mean(diabetes$score),]$Diabetes_binary==1)
sum(diabetes[diabetes$score>mean(diabetes$score),]$Diabetes_binary==1)
# Example variable
variable <- c(2, 5, 3, 1, 4)   # Replace with your own variable
# Calculate the mean of the variable
mean_value <- mean(variable)
# Create a new variable with values greater than mean as 1 and less than mean as 0
new_variable <- ifelse(variable > mean_value, 1, 0)
# Print the new variable
print(new_variable)
data_dir <- "~/Documents/STAT566/Project"
balanced_diabetes <- fread(file.path(data_dir, "diabetes_binary_5050split_health_indicators_BRFSS2015.csv"))
diabetes <- fread(file.path(data_dir,"diabetes_binary_health_indicators_BRFSS2015.csv"))
dim(balanced_diabetes)
balanced_diabetes[1:3,]
dim(diabetes)
diabetes[1:3,]
set.seed(1)
fit.forest= randomForest(Diabetes_binary ~ HvyAlcoholConsump + Smoker +
PhysActivity + Fruits + Veggies,
data = balanced_diabetes, na.action = na.roughfix)
importance(fit.forest)
w1 = importance(fit.forest)[1]/sum(importance(fit.forest))
w2 = importance(fit.forest)[2]/sum(importance(fit.forest))
w3 = importance(fit.forest)[3]/sum(importance(fit.forest))
w4 = importance(fit.forest)[4]/sum(importance(fit.forest))
w5 = importance(fit.forest)[5]/sum(importance(fit.forest))
score = -balanced_diabetes$HvyAlcoholConsump * w1 -
balanced_diabetes$Smoker * w2 +
balanced_diabetes$PhysActivity * w3 + balanced_diabetes$Fruits * w4 +
balanced_diabetes$Veggies * w5
summary(score)
hist(score)
set.seed(1)
fit.forest= randomForest(Diabetes_binary ~ HvyAlcoholConsump + Smoker +
PhysActivity + Fruits + Veggies,
data = balanced_diabetes, na.action = na.roughfix)
importance(fit.forest)
w1 = importance(fit.forest)[1]/sum(importance(fit.forest))
w2 = importance(fit.forest)[2]/sum(importance(fit.forest))
w3 = importance(fit.forest)[3]/sum(importance(fit.forest))
w4 = importance(fit.forest)[4]/sum(importance(fit.forest))
w5 = importance(fit.forest)[5]/sum(importance(fit.forest))
score = -balanced_diabetes$HvyAlcoholConsump * w1 -
balanced_diabetes$Smoker * w2 +
balanced_diabetes$PhysActivity * w3 + balanced_diabetes$Fruits * w4 +
balanced_diabetes$Veggies * w5
summary(score)
hist(score)
set.seed(1)
fit.forest= randomForest(Diabetes_binary ~ HvyAlcoholConsump + Smoker +
PhysActivity + Fruits + Veggies,
data = balanced_diabetes, na.action = na.roughfix)
importance(fit.forest)
w1 = importance(fit.forest)[1]/sum(importance(fit.forest))
w2 = importance(fit.forest)[2]/sum(importance(fit.forest))
w3 = importance(fit.forest)[3]/sum(importance(fit.forest))
w4 = importance(fit.forest)[4]/sum(importance(fit.forest))
w5 = importance(fit.forest)[5]/sum(importance(fit.forest))
score = -diabetes$HvyAlcoholConsump * w1 - diabetes$Smoker * w2 +
diabetes$PhysActivity * w3 + diabetes$Fruits * w4 + diabetes$Veggies * w5
summary(score)
hist(score)
mean_score <- mean(score)
diabetes$score <- score
diabetes %>% filter(score <= mean_score) %>% summarise(n=n())
diabetes %>% filter(score > mean_score) %>% summarise(n=n())
sum(diabetes[diabetes$score <= mean_score,]$Diabetes_binary==1)
sum(diabetes[diabetes$score > mean_score,]$Diabetes_binary==1)
mean_score <- mean(score)
diabetes$score <- score
diabetes %>% filter(score <= mean_score) %>% summarise(n=n())
diabetes %>% filter(score > mean_score) %>% summarise(n=n())
sum(diabetes[diabetes$score <= mean_score,]$Diabetes_binary==1)
sum(diabetes[diabetes$score > mean_score,]$Diabetes_binary==1)
scoreCat <- ifelse(score > mean_score, 1, 0)
mean_score <- mean(score)
diabetes$score <- score
diabetes %>% filter(score <= mean_score) %>% summarise(n=n())
diabetes %>% filter(score > mean_score) %>% summarise(n=n())
sum(diabetes[diabetes$score <= mean_score,]$Diabetes_binary==1)
sum(diabetes[diabetes$score > mean_score,]$Diabetes_binary==1)
scoreCat <- ifelse(score > mean_score, 1, 0)
scoreCat
mean_score <- mean(score)
diabetes$score <- score
diabetes %>% filter(score <= mean_score) %>% summarise(n=n())
diabetes %>% filter(score > mean_score) %>% summarise(n=n())
sum(diabetes[diabetes$score <= mean_score,]$Diabetes_binary == 1)
sum(diabetes[diabetes$score > mean_score,]$Diabetes_binary == 1)
diabetes$scoreCat <- ifelse(score > mean_score, 1, 0)
diabetes$scoreCat
data_dir <- "~/Documents/STAT566/Project"
balanced_diabetes <- fread(file.path(data_dir, "diabetes_binary_5050split_health_indicators_BRFSS2015.csv"))
diabetes <- fread(file.path(data_dir,"diabetes_binary_health_indicators_BRFSS2015.csv"))
dim(balanced_diabetes)
balanced_diabetes[1:3,]
dim(diabetes)
diabetes[1:3,]
sum(diabetes[diabetes$score <= mean_score,]
sum(diabetes[diabetes$score <= mean_score]
sum(diabetes$score <= mean_score)
sum(diabetes[diabetes$score <= mean_score,]
sum(diabetes[diabetes$score <= mean_score,])
mean_score <- mean(score)
diabetes$score <- score
diabetes %>% filter(score <= mean_score) %>% summarise(n=n())
diabetes %>% filter(score > mean_score) %>% summarise(n=n())
sum(diabetes[diabetes$score <= mean_score,]$Diabetes_binary == 1)
sum(diabetes[diabetes$score > mean_score,]$Diabetes_binary == 1)
diabetes$scoreCat <- ifelse(score > mean_score, 1, 0)
sum(diabetes[diabetes$score <= mean_score,])
sum(diabetes$score <= mean_score)
mean_score <- mean(score)
diabetes$score <- score
diabetes %>% filter(score <= mean_score) %>% summarise(n=n())
diabetes %>% filter(score > mean_score) %>% summarise(n=n())
sum(diabetes[diabetes$score <= mean_score,]$Diabetes_binary == 1)
sum(diabetes[diabetes$score > mean_score,]$Diabetes_binary == 1)
diabetes$scoreCat <- ifelse(score > mean_score, 1, 0)
mean_score <- mean(score)
diabetes$score <- score
sum(diabetes$score <= mean_score)
sum(diabetes$score > mean_score)
sum(diabetes[diabetes$score <= mean_score,]$Diabetes_binary == 1)
sum(diabetes[diabetes$score > mean_score,]$Diabetes_binary == 1)
diabetes$scoreCat <- ifelse(score > mean_score, 1, 0)
diabetes
diabetes
glm(Diabetes_binary ~ Smoker + PhysActivity + Fruits + Veggies +
HvyAlcoholConsump, data = diabetes, family = binomial)
model_treat <- glm(Diabetes_binary ~ Smoker + PhysActivity + Fruits + Veggies +
HvyAlcoholConsump, data = diabetes, family = binomial)
model_treat <- glm(Diabetes_binary ~ Smoker + PhysActivity + Fruits + Veggies +
HvyAlcoholConsump, data = diabetes, family = binomial)
summary(model_treat)
model_treat <- glm(Diabetes_binary ~ Smoker + PhysActivity + Fruits + Veggies +
HvyAlcoholConsump, data = diabetes, family = binomial)
summary(model_treat)
model_score <- glm(Diabetes_binary ~ scoreCat, data = diabetes,
family = binomial)
summary(model_score)
model_treat <- glm(Diabetes_binary ~ Smoker + PhysActivity + Fruits + Veggies +
HvyAlcoholConsump, data = diabetes, family = binomial)
summary(model_treat)
model_score <- glm(Diabetes_binary ~ scoreCat, data = diabetes,
family = binomial)
summary(model_score)
model_treat_adj <- glm(Diabetes_binary ~ Smoker + PhysActivity + Fruits +
Veggies + HvyAlcoholConsump + Sex + Age + Income,
data = diabetes, family = binomial)
summary(model_treat)
model_score_adj <- glm(Diabetes_binary ~ scoreCat + Sex + Age + Income,
data = diabetes, family = binomial)
summary(model_score)
model_treat_adj <- glm(Diabetes_binary ~ Smoker + PhysActivity + Fruits +
Veggies + HvyAlcoholConsump + Sex + Age + Income,
data = diabetes, family = binomial)
summary(model_treat_adj)
model_score_adj <- glm(Diabetes_binary ~ scoreCat + Sex + Age + Income,
data = diabetes, family = binomial)
summary(model_score_adj)
model_treat <- glm(Diabetes_binary ~ Smoker + PhysActivity + Fruits + Veggies +
HvyAlcoholConsump, data = diabetes, family = binomial)
summary(model_treat)
model_score <- glm(Diabetes_binary ~ scoreCat, data = diabetes,
family = binomial)
summary(model_score)
