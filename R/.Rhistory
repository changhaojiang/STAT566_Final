knitr::opts_chunk$set(echo = TRUE)
dis1 <- diabetes[, c("scoreCat", "Stroke", "HeartDiseaseorAttack", "Sex",
"Diabetes_binary", "Income")]
library(Rgraphviz)
library(RBGL)
library(abind)
library(corpcor)
library(sfsmisc)
library(robustbase)
library(pcalg)
library(graph)
library(abind)
library(data.table)
plotcpdag <- "Rgraphviz" %in% print(.packages(lib.loc = .libPaths()[1]))
plotcpdag
data_dir <- "~/Desktop"
diabetes <- fread(file.path(data_dir, "Diabetes.csv"))
diabetes$scoreCat <- ifelse(diabetes$scoreCat == "> mean score", 1, 0)
attr(diabetes,"names")
dim(diabetes)
diabetes[1:3]
dis1 <- diabetes[, c("scoreCat", "Stroke", "HeartDiseaseorAttack", "Sex",
"Diabetes_binary", "Income")]
V1 <- colnames(dis1)
sapply(dis1, function(v) nlevels(as.factor(v)))
suffStat1 <- list(dm = dis1, nlev = c(2,2,2,2,2,8), adaptDF = FALSE)
pc.D4 <- fci(suffStat4, indepTest = disCItest, alpha = 0.01,
labels = V4, verbose = TRUE)
dis1 <- diabetes[, c("scoreCat", "Stroke", "HeartDiseaseorAttack", "Sex",
"Diabetes_binary", "Income")]
V1 <- colnames(dis1)
sapply(dis1, function(v) nlevels(as.factor(v)))
suffStat1 <- list(dm = dis1, nlev = c(2,2,2,2,2,8), adaptDF = FALSE)
pc.D4 <- fci(suffStat1, indepTest = disCItest, alpha = 0.01,
labels = V1, verbose = TRUE)
if (require(Rgraphviz)) {
plot(pc.D1, main = "Estimated CPDAG", labels = c("scoreCat", "Stroke",
"HeartDiseaseorAttack", "Sex",
"Diabetes_binary", "Income"))
}
if (require(Rgraphviz)) {
plot(pc.D4, main = "Estimated CPDAG", labels = c("scoreCat", "Stroke",
"HeartDiseaseorAttack", "Sex",
"Diabetes_binary", "Income"))
}
fci_dis <- diabetes[,c("scoreCat", "Stroke", "HighChol", "HighBP", "BMI",
"HeartDiseaseorAttack", "Education", "AnyHealthcare",
"Income", "Sex", "Age", "Diabetes_binary")]
V <- colnames(fci_dis)
sapply(fci_dis, function(v) nlevels(as.factor(v)))
#suffStat1 <- list(dm = dis1, nlev = c(2,2,2,2,2,8), adaptDF = FALSE)
fci_dis <- diabetes[,c("scoreCat", "Stroke", "HighChol", "HighBP", "BMI",
"HeartDiseaseorAttack", "Education", "AnyHealthcare",
"Income", "Sex", "Age", "Diabetes_binary")]
V <- colnames(fci_dis)
sapply(fci_dis, function(v) nlevels(as.factor(v)))
#suffStat1 <- list(dm = dis1, nlev = c(2,2,2,2,2,8), adaptDF = FALSE)
fci_dis <- diabetes[,c("scoreCat", "Stroke", "HighChol", "HighBP",
"HeartDiseaseorAttack", "Education", "AnyHealthcare",
"Income", "Sex", "Diabetes_binary")]
V <- colnames(fci_dis)
sapply(fci_dis, function(v) nlevels(as.factor(v)))
#suffStat <- list(dm = fci_dis, nlev = c(2,2,2,2,2,8), adaptDF = FALSE)
fci_dis <- diabetes[,c("scoreCat", "Stroke", "HighChol", "HighBP",
"HeartDiseaseorAttack", "Education", "AnyHealthcare",
"Income", "Sex", "Diabetes_binary")]
V <- colnames(fci_dis)
sapply(fci_dis, function(v) nlevels(as.factor(v)))
suffStat <- list(dm = fci_dis, nlev = c(2,2,2,2,2,6,2,8,2,2), adaptDF = FALSE)
pc.D <- fci(suffStat1, indepTest = disCItest, alpha = 0.01,
labels = V, verbose = TRUE)
fci_dis <- diabetes[,c("scoreCat", "Stroke", "HighChol", "HighBP",
"HeartDiseaseorAttack", "Education", "AnyHealthcare",
"Income", "Sex", "Diabetes_binary")]
V <- colnames(fci_dis)
sapply(fci_dis, function(v) nlevels(as.factor(v)))
suffStat <- list(dm = fci_dis, nlev = c(2,2,2,2,2,6,2,8,2,2), adaptDF = FALSE)
pc.D <- fci(suffStat, indepTest = disCItest, alpha = 0.01,
labels = V, verbose = TRUE)
