suffStat <- list(dm = fci_dis, nlev = c(2,2,2,2,2,6,2,2), adaptDF = FALSE)
pc.D <- fci(suffStat, indepTest = disCItest, alpha = 0.01,
labels = V, verbose = TRUE)
fci_dis <- diabetes[,c("scoreCat", "HighChol", "HighBP",
"HeartDiseaseorAttack", "Education", "AnyHealthcare",
"Diabetes_binary")]
V <- colnames(fci_dis)
sapply(fci_dis, function(v) nlevels(as.factor(v)))
suffStat <- list(dm = fci_dis, nlev = c(2,2,2,2,6,2,2), adaptDF = FALSE)
pc.D <- fci(suffStat, indepTest = disCItest, alpha = 0.01,
labels = V, verbose = TRUE)
knitr::opts_chunk$set(echo = TRUE)
data_dir <- "~/Documents/STAT566/Project"
balanced_diabetes <- fread(file.path(data_dir, "diabetes_binary_5050split_health_indicators_BRFSS2015.csv"))
diabetes <- fread(file.path(data_dir,"diabetes_binary_health_indicators_BRFSS2015.csv"))
dim(balanced_diabetes)
balanced_diabetes[1:3,]
dim(diabetes)
diabetes[1:3,]
model_treat_adj <- glm(Diabetes_binary ~ Smoker + PhysActivity + Fruits +
Veggies + HvyAlcoholConsump + Sex + Age + Income,
data = diabetes, family = binomial)
summary(model_treat_adj)
model_score_adj <- glm(Diabetes_binary ~ scoreCat + Sex + Age + Income + Education,
data = diabetes, family = binomial)
library(data.table)
library(randomForest)
data_dir <- "~/Documents/STAT566/Project"
balanced_diabetes <- fread(file.path(data_dir, "diabetes_binary_5050split_health_indicators_BRFSS2015.csv"))
diabetes <- fread(file.path(data_dir,"diabetes_binary_health_indicators_BRFSS2015.csv"))
dim(balanced_diabetes)
balanced_diabetes[1:3,]
dim(diabetes)
diabetes[1:3,]
set.seed(1)
fit.forest= randomForest(Diabetes_binary ~ HvyAlcoholConsump + Smoker +
PhysActivity + Fruits + Veggies,
data = balanced_diabetes, na.action = na.roughfix)
importance(fit.forest)
w1 = importance(fit.forest)[1] / sum(importance(fit.forest))
w2 = importance(fit.forest)[2] / sum(importance(fit.forest))
w3 = importance(fit.forest)[3] / sum(importance(fit.forest))
w4 = importance(fit.forest)[4] / sum(importance(fit.forest))
w5 = importance(fit.forest)[5] / sum(importance(fit.forest))
diabetes$score = -diabetes$HvyAlcoholConsump * w1 - diabetes$Smoker * w2 +
diabetes$PhysActivity * w3 + diabetes$Fruits * w4 + diabetes$Veggies * w5
summary(diabetes$score)
hist(diabetes$score)
mean_score <- mean(diabetes$score)
sum(diabetes$score <= mean_score)
sum(diabetes$score > mean_score)
sum(diabetes[diabetes$score <= mean_score,]$Diabetes_binary == 1)
sum(diabetes[diabetes$score > mean_score,]$Diabetes_binary == 1)
diabetes$scoreCat <- ifelse(diabetes$score > mean_score, 1, 0)
model_treat <- glm(Diabetes_binary ~ Smoker + PhysActivity + Fruits + Veggies +
HvyAlcoholConsump, data = diabetes, family = binomial)
summary(model_treat)
model_score <- glm(Diabetes_binary ~ scoreCat, data = diabetes,
family = binomial)
summary(model_score)
model_treat_adj <- glm(Diabetes_binary ~ Smoker + PhysActivity + Fruits +
Veggies + HvyAlcoholConsump + Sex + Age + Income,
data = diabetes, family = binomial)
summary(model_treat_adj)
model_score_adj <- glm(Diabetes_binary ~ scoreCat + Sex + Age + Income + Education,
data = diabetes, family = binomial)
summary(model_score_adj)
model_score_adj <- glm(Diabetes_binary ~ scoreCat + Sex + Age + Income,
data = diabetes, family = binomial)
summary(model_score_adj)
reg_results <- summary(model_score)$coefficients
rownames(reg_results) <- NULL  # Remove row names
# Format p-values
reg_results[, "Pr(>|t|)"] <- format.pval(reg_results[, "Pr(>|t|)"], digits = 3)
model_treat <- glm(Diabetes_binary ~ Smoker + PhysActivity + Fruits + Veggies +
HvyAlcoholConsump, data = diabetes, family = binomial)
summary(model_treat)
model_score <- glm(Diabetes_binary ~ scoreCat, data = diabetes,
family = binomial)
summary(model_score)
reg_results <- summary(model_score)$coefficients
rownames(reg_results) <- NULL  # Remove row names
# Format p-values
reg_results[, "Pr(>|t|)"] <- format.pval(reg_results[, "Pr(>|z|) "], digits = 3)
reg_results <- summary(model_score)$coefficients
rownames(reg_results) <- NULL  # Remove row names
# Format p-values
reg_results[, "Pr(>|t|)"] <- format.pval(reg_results[, "Pr(>|z|)"], digits = 3)
reg_results <- summary(model_score)$coefficients
rownames(reg_results) <- NULL  # Remove row names
# Format p-values
#reg_results[, "Pr(>|t|)"] <- format.pval(reg_results[, "Pr(>|z|)"], digits = 3)
# Create the table using knitr::kable
knitr::kable(reg_results, digits = c(2, 2, 2, 3), align = "c", caption = "Linear Regression Results")
# The 'digits' argument specifies the number of decimal places to display for each column.
# 'align' argument can be adjusted to align the columns ('c' for center, 'l' for left, 'r' for right).
# 'caption' can be customized to provide a descriptive caption for the table.
reg_results
summary(model_score)$coefficients
reg_results$"Std. Error"
reg_results[,"Std. Error"]
reg_results[,"Std. Error"] <- 1
reg_results
reg_results[1,"Std. Error"] <- 1
reg_results[1,"Std. Error"] <- 2
reg_results
names(reg_results)
colnames(reg_results)
colnames(reg_results) <- c("a","b","c","d")
reg_results
knitr::kable(reg_results, digits = c(2, 2, 2, 3), align = "c", caption = "Linear Regression Results")
Confint(model_score_adj, vcov. = vcovHC(m6, type = "HC0"))
library(data.table)
library(randomForest)
library(sandwich)
library(car)
Confint(model_score_adj, vcov. = vcovHC(m6, type = "HC0"))
Confint(model_score_adj, vcov. = vcovHC(model_score_adj, type = "HC0"))
model_score <- glm(Diabetes_binary ~ scoreCat, data = diabetes,
family = binomial)
summary(model_score)
Confint(model_score, vcov. = vcovHC(model_score, type = "HC0"))
model_score_adj <- glm(Diabetes_binary ~ scoreCat + Sex + Age + Income,
data = diabetes, family = binomial)
summary(model_score_adj)
Confint(model_score_adj, vcov. = vcovHC(model_score_adj, type = "HC0"))
model_score <- glm(Diabetes_binary ~ scoreCat, data = diabetes,
family = binomial)
summary(model_score)
Confint(model_score, vcov. = vcovHC(model_score, type = "HC0"))
model_score_adj <- glm(Diabetes_binary ~ scoreCat + Sex + Age + Income,
data = diabetes, family = binomial)
summary(model_score_adj)
Confint(model_score_adj, vcov. = vcovHC(model_score_adj, type = "HC0"))
model_score_adj$coefficients
model_score$coefficients
model_score <- glm(Diabetes_binary ~ scoreCat, data = diabetes,
family = binomial)
summary(model_score)
Confint(model_score, vcov. = vcovHC(model_score, type = "HC0"))
summary(model_score)$coefficients
summary(model_score)$coefficients
results <- summary(model_score)$coefficients
rownames(results)
results <- summary(model_score)$coefficients
rownames(results) <- c("score", "adjusted score")
results <- summary(model_score)$coefficients
rownames(results) <- c("score", "adjusted score")
results
results <- summary(model_score)$coefficients
rownames(results) <- c("score", "adjusted score")
results <- results[, c("Estimate", "Std. Error", "z value")]
results <- summary(model_score)$coefficients
rownames(results) <- c("score", "adjusted score")
results <- results[, c("Estimate", "Std. Error", "z value")]
results
results <- summary(model_score)$coefficients
rownames(results) <- c("score", "adjusted score")
results <- results[, c("Estimate", "Std. Error", "z value")]
results["score",]
results <- summary(model_score)$coefficients
rownames(results) <- c("score", "adjusted score")
results <- results[, c("Estimate", "Std. Error", "z value")]
results["score", ] <- c(-0.5980872, -0.620951, -0.5752233)
results["adjusted score", ] <- c(-0.3774651, -0.4016496, -0.3532806)
knitr::kable(results, digits = c(4, 4, 4), align = "c", caption = "Adjustment Results")
results <- summary(model_score)$coefficients
rownames(results) <- c("score", "adjusted score")
results <- results[, c("Estimate", "Std. Error", "z value")]
colnames(results) <- c("Estimate", "2.5 %", "97.5 %")
results["score", ] <- c(-0.5980872, -0.620951, -0.5752233)
results["adjusted score", ] <- c(-0.3774651, -0.4016496, -0.3532806)
knitr::kable(results, digits = c(4, 4, 4), align = "c", caption = "Adjustment Results")
results <- summary(model_score)$coefficients
rownames(results) <- c("score", "adjusted score")
results <- results[, c("Estimate", "Std. Error", "z value")]
colnames(results) <- c("Estimate", "2.5 %", "97.5 %")
results["score", ] <- c(-0.5980872, -0.620951, -0.5752233)
results["adjusted score", ] <- c(-0.3774651, -0.4016496, -0.3532806)
knitr::kable(results, digits = c(4, 4, 4), align = "c", caption = "Adjustment Results")
results <- summary(model_score)$coefficients
rownames(results) <- c("score", "adjusted score")
results <- results[, c("Estimate", "Std. Error", "z value")]
colnames(results) <- c("Estimate", "2.5 %", "97.5 %")
results["score", ] <- c(-0.5980872, -0.620951, -0.5752233)
results["adjusted score", ] <- c(-0.3774651, -0.4016496, -0.3532806)
knitr::kable(results, digits = c(4, 4, 4), align = "c", caption = "Adjustment Results")
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
install.packages("tidyverse")
library(knitr)
library(tidyverse)
#library(rigr)
library(dplyr)
#library(gtsummary)
#library(flextable)
library(ggplot2)
data$ageCat <- factor(data$Age, levels = 1:13, labels = c("18-24", "25-29", "30-34", "35-39", "40-44", "45-49", "50-54", "55-59", "60-64", "65-69", "70-74", "75-79", ">=80") )
data_dir <- "~/Documents/STAT566/Project"
#balanced_diabetes <- fread(file.path(data_dir, "diabetes_binary_5050split_health_indicators_BRFSS2015.csv"))
data <- fread(file.path(data_dir,"diabetes_binary_health_indicators_BRFSS2015.csv"))
data$ageCat <- factor(data$Age, levels = 1:13, labels = c("18-24", "25-29", "30-34", "35-39", "40-44", "45-49", "50-54", "55-59", "60-64", "65-69", "70-74", "75-79", ">=80") )
data$eduCat <- factor(data$Education, levels = 1:6, labels = c("Never attended school or only kindergarten", "Elementary", "Some high school", "High school graduate", "Some college or technical school", "College graduate"))
data$incomeCat <- factor(data$Income, levels = 1:8, labels = c("< $10,000", "[$10,000, $15,000)", "[$15,000, $20,000)", "[$20,000, $25,000)", "[$25,000, $35,000)", "[$35,000, $50,000)", "[$50,000, $75,000)", ">= $75,000"))
data$diaCat <- factor(data$Diabetes_binary, levels = 0:1, labels = c("Healthy", "Prediabetes or diabetes"))
data$scoreCat2 = ifelse(data$scoreCat == "> mean score", 1, 0)
data$scoreCat2 <- as.numeric(data$scoreCat2)
data$Diabetes_binary <- as.numeric(data$Diabetes_binary)
data$gender <- factor(data$Sex, levels = 0:1, labels = c("Female", "Male"))
tabl1 <- data %>% select(Diabetes_binary, Sex, ageCat, eduCat, incomeCat, scoreCat, Smoker,
PhysActivity, Fruits, Veggies, HvyAlcoholConsump, HighBP, HighChol,
BMI, Stroke, HeartDiseaseorAttack, AnyHealthcare) %>%
tbl_summary(by = Diabetes_binary, label = list(Diabetes_binary ~ "Diagnosis of diabetes",
Sex ~ "Gender", ageCat ~ "5-year age category", eduCat ~ "Education", incomeCat ~ "Income", scoreCat ~ "Lifestyle composition score", Smoker ~ "Have smoked at least 100 cigarettes lifetime", PhysActivity ~ "Physical activity in past 30 days (not including job)", Fruits ~ "Consume fruit >= 1 times per day", Veggies ~ "Consume vegetables >= 1 times per day", HvyAlcoholConsump ~ "Heavy drinkers", HighBP ~ "High blood pressure", HighChol ~ "High cholesterol", Stroke ~ "Ever had a stroke", HeartDiseaseorAttack ~ "Coronary heart disease or myocardial infarction", AnyHealthcare ~ "Any health coverage"),
statistic = all_continuous() ~ "{mean}({sd})",
type = all_continuous() ~ 'continuous2',
missing = "no") %>% add_p()
plot_income <- ggplot(data,
aes(x=factor(incomeCat), fill = factor(diaCat))) +
geom_bar(position = "dodge", width = 0.8)+
scale_fill_manual(values = c("Healthy" = "lightblue", "Prediabetes or diabetes" = "darkorange"))+
labs(x = "Income category", y = "Count", fill = "Diabetes status") +
facet_wrap(~scoreCat, ncol =1) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Income of participants in different lifestyle score category and diabetes status")
plot_income
library(knitr)
library(tidyverse)
library(rigr)
install.packages("rigr")
library(knitr)
library(tidyverse)
library(rigr)
library(dplyr)
#library(gtsummary)
#library(flextable)
library(ggplot2)
data$ageCat <- factor(data$Age, levels = 1:13, labels = c("18-24", "25-29", "30-34", "35-39", "40-44", "45-49", "50-54", "55-59", "60-64", "65-69", "70-74", "75-79", ">=80") )
data$eduCat <- factor(data$Education, levels = 1:6, labels = c("Never attended school or only kindergarten", "Elementary", "Some high school", "High school graduate", "Some college or technical school", "College graduate"))
data$incomeCat <- factor(data$Income, levels = 1:8, labels = c("< $10,000", "[$10,000, $15,000)", "[$15,000, $20,000)", "[$20,000, $25,000)", "[$25,000, $35,000)", "[$35,000, $50,000)", "[$50,000, $75,000)", ">= $75,000"))
data$diaCat <- factor(data$Diabetes_binary, levels = 0:1, labels = c("Healthy", "Prediabetes or diabetes"))
data$scoreCat2 = ifelse(data$scoreCat == "> mean score", 1, 0)
data$scoreCat2 <- as.numeric(data$scoreCat2)
data$Diabetes_binary <- as.numeric(data$Diabetes_binary)
data$gender <- factor(data$Sex, levels = 0:1, labels = c("Female", "Male"))
set.seed(1)
fit.forest= randomForest(Diabetes_binary ~ HvyAlcoholConsump + Smoker +
PhysActivity + Fruits + Veggies,
data = balanced_diabetes, na.action = na.roughfix)
importance(fit.forest)
w1 = importance(fit.forest)[1] / sum(importance(fit.forest))
w2 = importance(fit.forest)[2] / sum(importance(fit.forest))
w3 = importance(fit.forest)[3] / sum(importance(fit.forest))
w4 = importance(fit.forest)[4] / sum(importance(fit.forest))
w5 = importance(fit.forest)[5] / sum(importance(fit.forest))
diabetes$score = -diabetes$HvyAlcoholConsump * w1 - diabetes$Smoker * w2 +
diabetes$PhysActivity * w3 + diabetes$Fruits * w4 + diabetes$Veggies * w5
summary(diabetes$score)
hist(diabetes$score)
set.seed(1)
fit.forest= randomForest(Diabetes_binary ~ HvyAlcoholConsump + Smoker +
PhysActivity + Fruits + Veggies,
data = balanced_diabetes, na.action = na.roughfix)
importance(fit.forest)
w1 = importance(fit.forest)[1] / sum(importance(fit.forest))
w2 = importance(fit.forest)[2] / sum(importance(fit.forest))
w3 = importance(fit.forest)[3] / sum(importance(fit.forest))
w4 = importance(fit.forest)[4] / sum(importance(fit.forest))
w5 = importance(fit.forest)[5] / sum(importance(fit.forest))
diabetes$score = -diabetes$HvyAlcoholConsump * w1 - diabetes$Smoker * w2 +
diabetes$PhysActivity * w3 + diabetes$Fruits * w4 + diabetes$Veggies * w5
mean_score <- mean(diabetes$score)
diabetes$scoreCat <- ifelse(diabetes$score > mean_score, 1, 0)
tabl1 <- data %>% select(Diabetes_binary, Sex, ageCat, eduCat, incomeCat,
scoreCat, Smoker,PhysActivity, Fruits, Veggies,
HvyAlcoholConsump, HighBP, HighChol, BMI, Stroke,
HeartDiseaseorAttack, AnyHealthcare) %>%
tbl_summary(by = Diabetes_binary, label = list(Diabetes_binary ~ "Diagnosis of diabetes",
Sex ~ "Gender", ageCat ~ "5-year age category", eduCat ~ "Education", incomeCat ~ "Income", scoreCat ~ "Lifestyle composition score", Smoker ~ "Have smoked at least 100 cigarettes lifetime", PhysActivity ~ "Physical activity in past 30 days (not including job)", Fruits ~ "Consume fruit >= 1 times per day", Veggies ~ "Consume vegetables >= 1 times per day", HvyAlcoholConsump ~ "Heavy drinkers", HighBP ~ "High blood pressure", HighChol ~ "High cholesterol", Stroke ~ "Ever had a stroke", HeartDiseaseorAttack ~ "Coronary heart disease or myocardial infarction", AnyHealthcare ~ "Any health coverage"),
statistic = all_continuous() ~ "{mean}({sd})",
type = all_continuous() ~ 'continuous2',
missing = "no") %>% add_p()
install.packages("gtsummary")
data$ageCat <- factor(data$Age, levels = 1:13, labels = c("18-24", "25-29", "30-34", "35-39", "40-44", "45-49", "50-54", "55-59", "60-64", "65-69", "70-74", "75-79", ">=80") )
data$eduCat <- factor(data$Education, levels = 1:6, labels = c("Never attended school or only kindergarten", "Elementary", "Some high school", "High school graduate", "Some college or technical school", "College graduate"))
data$incomeCat <- factor(data$Income, levels = 1:8, labels = c("< $10,000", "[$10,000, $15,000)", "[$15,000, $20,000)", "[$20,000, $25,000)", "[$25,000, $35,000)", "[$35,000, $50,000)", "[$50,000, $75,000)", ">= $75,000"))
data$diaCat <- factor(data$Diabetes_binary, levels = 0:1, labels = c("Healthy", "Prediabetes or diabetes"))
data$scoreCat2 = ifelse(data$scoreCat == "> mean score", 1, 0)
data$scoreCat2 <- as.numeric(data$scoreCat2)
data$Diabetes_binary <- as.numeric(data$Diabetes_binary)
data$gender <- factor(data$Sex, levels = 0:1, labels = c("Female", "Male"))
tabl1 <- data %>% select(Diabetes_binary, Sex, ageCat, eduCat, incomeCat,
scoreCat, Smoker,PhysActivity, Fruits, Veggies,
HvyAlcoholConsump, HighBP, HighChol, BMI, Stroke,
HeartDiseaseorAttack, AnyHealthcare) %>%
tbl_summary(by = Diabetes_binary, label = list(Diabetes_binary ~ "Diagnosis of diabetes",
Sex ~ "Gender", ageCat ~ "5-year age category", eduCat ~ "Education", incomeCat ~ "Income", scoreCat ~ "Lifestyle composition score", Smoker ~ "Have smoked at least 100 cigarettes lifetime", PhysActivity ~ "Physical activity in past 30 days (not including job)", Fruits ~ "Consume fruit >= 1 times per day", Veggies ~ "Consume vegetables >= 1 times per day", HvyAlcoholConsump ~ "Heavy drinkers", HighBP ~ "High blood pressure", HighChol ~ "High cholesterol", Stroke ~ "Ever had a stroke", HeartDiseaseorAttack ~ "Coronary heart disease or myocardial infarction", AnyHealthcare ~ "Any health coverage"),
statistic = all_continuous() ~ "{mean}({sd})",
type = all_continuous() ~ 'continuous2',
missing = "no") %>% add_p()
install.packages("flextable")
tabl1 <- data %>% select(Diabetes_binary, Sex, ageCat, eduCat, incomeCat,
scoreCat, Smoker,PhysActivity, Fruits, Veggies,
HvyAlcoholConsump, HighBP, HighChol, BMI, Stroke,
HeartDiseaseorAttack, AnyHealthcare) %>%
tbl_summary(by = Diabetes_binary, label = list(Diabetes_binary ~ "Diagnosis of diabetes",
Sex ~ "Gender", ageCat ~ "5-year age category", eduCat ~ "Education", incomeCat ~ "Income", scoreCat ~ "Lifestyle composition score", Smoker ~ "Have smoked at least 100 cigarettes lifetime", PhysActivity ~ "Physical activity in past 30 days (not including job)", Fruits ~ "Consume fruit >= 1 times per day", Veggies ~ "Consume vegetables >= 1 times per day", HvyAlcoholConsump ~ "Heavy drinkers", HighBP ~ "High blood pressure", HighChol ~ "High cholesterol", Stroke ~ "Ever had a stroke", HeartDiseaseorAttack ~ "Coronary heart disease or myocardial infarction", AnyHealthcare ~ "Any health coverage"),
statistic = all_continuous() ~ "{mean}({sd})",
type = all_continuous() ~ 'continuous2',
missing = "no") %>% add_p()
tabl1 <- data %>% select(Diabetes_binary, Sex, ageCat, eduCat, incomeCat,
scoreCat, Smoker,PhysActivity, Fruits, Veggies,
HvyAlcoholConsump, HighBP, HighChol, BMI, Stroke,
HeartDiseaseorAttack, AnyHealthcare) %>%
tbl_summary(by = Diabetes_binary, label = list(Diabetes_binary ~ "Diagnosis of diabetes",
Sex ~ "Gender", ageCat ~ "5-year age category", eduCat ~ "Education", incomeCat ~ "Income", scoreCat ~ "Lifestyle composition score", Smoker ~ "Have smoked at least 100 cigarettes lifetime", PhysActivity ~ "Physical activity in past 30 days (not including job)", Fruits ~ "Consume fruit >= 1 times per day", Veggies ~ "Consume vegetables >= 1 times per day", HvyAlcoholConsump ~ "Heavy drinkers", HighBP ~ "High blood pressure", HighChol ~ "High cholesterol", Stroke ~ "Ever had a stroke", HeartDiseaseorAttack ~ "Coronary heart disease or myocardial infarction", AnyHealthcare ~ "Any health coverage"),
statistic = all_continuous() ~ "{mean}({sd})",
type = all_continuous() ~ 'continuous2',
missing = "no") %>% add_p()
library(knitr)
library(tidyverse)
library(rigr)
library(dplyr)
library(gtsummary)
library(flextable)
library(ggplot2)
data_dir <- "~/Documents/STAT566/Project"
balanced_diabetes <- fread(file.path(data_dir, "diabetes_binary_5050split_health_indicators_BRFSS2015.csv"))
data <- fread(file.path(data_dir,"diabetes_binary_health_indicators_BRFSS2015.csv"))
set.seed(1)
fit.forest= randomForest(Diabetes_binary ~ HvyAlcoholConsump + Smoker +
PhysActivity + Fruits + Veggies,
data = balanced_diabetes, na.action = na.roughfix)
importance(fit.forest)
w1 = importance(fit.forest)[1] / sum(importance(fit.forest))
w2 = importance(fit.forest)[2] / sum(importance(fit.forest))
w3 = importance(fit.forest)[3] / sum(importance(fit.forest))
w4 = importance(fit.forest)[4] / sum(importance(fit.forest))
w5 = importance(fit.forest)[5] / sum(importance(fit.forest))
diabetes$score = -diabetes$HvyAlcoholConsump * w1 - diabetes$Smoker * w2 +
diabetes$PhysActivity * w3 + diabetes$Fruits * w4 + diabetes$Veggies * w5
mean_score <- mean(diabetes$score)
diabetes$scoreCat <- ifelse(diabetes$score > mean_score, 1, 0)
data$ageCat <- factor(data$Age, levels = 1:13, labels = c("18-24", "25-29", "30-34", "35-39", "40-44", "45-49", "50-54", "55-59", "60-64", "65-69", "70-74", "75-79", ">=80") )
data$eduCat <- factor(data$Education, levels = 1:6, labels = c("Never attended school or only kindergarten", "Elementary", "Some high school", "High school graduate", "Some college or technical school", "College graduate"))
data$incomeCat <- factor(data$Income, levels = 1:8, labels = c("< $10,000", "[$10,000, $15,000)", "[$15,000, $20,000)", "[$20,000, $25,000)", "[$25,000, $35,000)", "[$35,000, $50,000)", "[$50,000, $75,000)", ">= $75,000"))
data$diaCat <- factor(data$Diabetes_binary, levels = 0:1, labels = c("Healthy", "Prediabetes or diabetes"))
data$scoreCat2 = ifelse(data$scoreCat == "> mean score", 1, 0)
data$scoreCat2 <- as.numeric(data$scoreCat2)
data$Diabetes_binary <- as.numeric(data$Diabetes_binary)
data$gender <- factor(data$Sex, levels = 0:1, labels = c("Female", "Male"))
tabl1 <- data %>% select(Diabetes_binary, Sex, ageCat, eduCat, incomeCat,
scoreCat, Smoker,PhysActivity, Fruits, Veggies,
HvyAlcoholConsump, HighBP, HighChol, BMI, Stroke,
HeartDiseaseorAttack, AnyHealthcare) %>%
tbl_summary(by = Diabetes_binary, label = list(Diabetes_binary ~ "Diagnosis of diabetes",
Sex ~ "Gender", ageCat ~ "5-year age category", eduCat ~ "Education", incomeCat ~ "Income", scoreCat ~ "Lifestyle composition score", Smoker ~ "Have smoked at least 100 cigarettes lifetime", PhysActivity ~ "Physical activity in past 30 days (not including job)", Fruits ~ "Consume fruit >= 1 times per day", Veggies ~ "Consume vegetables >= 1 times per day", HvyAlcoholConsump ~ "Heavy drinkers", HighBP ~ "High blood pressure", HighChol ~ "High cholesterol", Stroke ~ "Ever had a stroke", HeartDiseaseorAttack ~ "Coronary heart disease or myocardial infarction", AnyHealthcare ~ "Any health coverage"),
statistic = all_continuous() ~ "{mean}({sd})",
type = all_continuous() ~ 'continuous2',
missing = "no") %>% add_p()
set.seed(1)
fit.forest= randomForest(Diabetes_binary ~ HvyAlcoholConsump + Smoker +
PhysActivity + Fruits + Veggies,
data = balanced_diabetes, na.action = na.roughfix)
importance(fit.forest)
w1 = importance(fit.forest)[1] / sum(importance(fit.forest))
w2 = importance(fit.forest)[2] / sum(importance(fit.forest))
w3 = importance(fit.forest)[3] / sum(importance(fit.forest))
w4 = importance(fit.forest)[4] / sum(importance(fit.forest))
w5 = importance(fit.forest)[5] / sum(importance(fit.forest))
diabetes$score = -diabetes$HvyAlcoholConsump * w1 - diabetes$Smoker * w2 +
diabetes$PhysActivity * w3 + diabetes$Fruits * w4 + diabetes$Veggies * w5
mean_score <- mean(diabetes$score)
diabetes$scoreCat <- ifelse(diabetes$score > mean_score, 1, 0)
data <- diabetes
data$ageCat <- factor(data$Age, levels = 1:13, labels = c("18-24", "25-29", "30-34", "35-39", "40-44", "45-49", "50-54", "55-59", "60-64", "65-69", "70-74", "75-79", ">=80") )
data$eduCat <- factor(data$Education, levels = 1:6, labels = c("Never attended school or only kindergarten", "Elementary", "Some high school", "High school graduate", "Some college or technical school", "College graduate"))
data$incomeCat <- factor(data$Income, levels = 1:8, labels = c("< $10,000", "[$10,000, $15,000)", "[$15,000, $20,000)", "[$20,000, $25,000)", "[$25,000, $35,000)", "[$35,000, $50,000)", "[$50,000, $75,000)", ">= $75,000"))
data$diaCat <- factor(data$Diabetes_binary, levels = 0:1, labels = c("Healthy", "Prediabetes or diabetes"))
data$scoreCat2 = ifelse(data$scoreCat == "> mean score", 1, 0)
data$scoreCat2 <- as.numeric(data$scoreCat2)
data$Diabetes_binary <- as.numeric(data$Diabetes_binary)
data$gender <- factor(data$Sex, levels = 0:1, labels = c("Female", "Male"))
tabl1 <- data %>% select(Diabetes_binary, Sex, ageCat, eduCat, incomeCat,
scoreCat, Smoker,PhysActivity, Fruits, Veggies,
HvyAlcoholConsump, HighBP, HighChol, BMI, Stroke,
HeartDiseaseorAttack, AnyHealthcare) %>%
tbl_summary(by = Diabetes_binary, label = list(Diabetes_binary ~ "Diagnosis of diabetes",
Sex ~ "Gender", ageCat ~ "5-year age category", eduCat ~ "Education", incomeCat ~ "Income", scoreCat ~ "Lifestyle composition score", Smoker ~ "Have smoked at least 100 cigarettes lifetime", PhysActivity ~ "Physical activity in past 30 days (not including job)", Fruits ~ "Consume fruit >= 1 times per day", Veggies ~ "Consume vegetables >= 1 times per day", HvyAlcoholConsump ~ "Heavy drinkers", HighBP ~ "High blood pressure", HighChol ~ "High cholesterol", Stroke ~ "Ever had a stroke", HeartDiseaseorAttack ~ "Coronary heart disease or myocardial infarction", AnyHealthcare ~ "Any health coverage"),
statistic = all_continuous() ~ "{mean}({sd})",
type = all_continuous() ~ 'continuous2',
missing = "no") %>% add_p()
plot_income <- ggplot(data,
aes(x=factor(incomeCat), fill = factor(diaCat))) +
geom_bar(position = "dodge", width = 0.8)+
scale_fill_manual(values = c("Healthy" = "lightblue", "Prediabetes or diabetes" = "darkorange"))+
labs(x = "Income category", y = "Count", fill = "Diabetes status") +
facet_wrap(~scoreCat, ncol =1) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Income of participants in different lifestyle score category and diabetes status")
plot_income
ggsave("income.png")
# plots on age categories
plot_age <- ggplot(data,
aes(x=factor(ageCat), fill = factor(diaCat))) +
geom_bar(position = "dodge", width = 0.8)+
scale_fill_manual(values = c("Healthy" = "lightblue", "Prediabetes or diabetes" = "darkorange"))+
labs(x = "Age category", y = "Count", fill = "Diabetes status") +
facet_wrap(~scoreCat, ncol =1) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
ggtitle("Age of participants in different lifestyle score category and diabetes status")
ggsave("age.png")
# plot on gender
plot_gender <- ggplot(data,
aes(x=gender, fill = factor(diaCat))) +
geom_bar(position = "dodge", width = 0.8)+
scale_fill_manual(values = c("Healthy" = "lightblue", "Prediabetes or diabetes" = "darkorange"))+
labs(x = "Gender", y = "Count", fill = "Diabetes status") +
facet_wrap(~scoreCat, ncol =1) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
ggtitle("Gender of participants in different lifestyle score category and diabetes status")
ggsave("gender.png")
knitr::opts_chunk$set(echo = TRUE)
data <- read.csv("~/Desktop/STAT566/Diabetes.csv")
data_dir <- "~/Desktop"
data <- fread(file.path(data_dir, "Diabetes.csv"))
data$scoreCat <- ifelse(data$scoreCat == "> mean score",1,0)
rW  = cbind(data$Age,data$Sex,data$Income)
rW = as.matrix(rW)
rA = data$scoreCat
rY = data$Diabetes_binary
set.seed(1)
library(rlearner)
install.packages("rlearner")
rW  = cbind(data$Age,data$Sex,data$Income)
rW = as.matrix(rW)
rA = data$scoreCat
rY = data$Diabetes_binary
set.seed(1)
library(rlearner)
library(devtools)
install_github("xnie/rlearner")
rW  = cbind(data$Age,data$Sex,data$Income)
rW = as.matrix(rW)
rA = data$scoreCat
rY = data$Diabetes_binary
set.seed(1)
library(rlearner)
rlasso_fit = rlasso(rW, rA, rY,k_folds = 10)
rlasso_est = predict(rlasso_fit, rW)
plotdata <- data.frame(Income = data$Income,
Estimator =rlasso_est)
plotdata$Income_Group <- cut(plotdata$Income, breaks=c(0,2, 4,6, 8), labels=c("<15000","[15000,25000)","[25000,50000)", ">=50000"))
library(ggplot2)
ggplot(plotdata, aes(x = Income_Group, y = Estimator, fill = Income_Group)) +
geom_boxplot() +
ggtitle("The result of R-learner(Income)") +
xlab("Income Group") +
ylab("Estimator") +
scale_fill_brewer(palette="Set1") +
theme_bw()
plotdata <- data.frame(Sex = data$Sex,
Estimator =rlasso_est)
plotdata$Gender_Group <- ifelse(plotdata$Sex==0,"Female","Male")
library(ggplot2)
ggplot(plotdata, aes(x = Gender_Group, y = Estimator, fill = Gender_Group)) +
geom_boxplot() +
ggtitle("The result of R-learner(Gender)") +
xlab("Gender Group") +
ylab("Estimator") +
scale_fill_brewer(palette="Set2") +
theme_bw()
plotdata <- data.frame(Age = data$Age,
Estimator =rlasso_est)
plotdata$Age = as.factor(plotdata$Age)
library(ggplot2)
age_labels <- c("18-24","25-29","30-34","35-39","40-44","45-49","51-54","55-59","60-64","65-69","70-74","75-79",">=80")
ggplot(plotdata, aes(x = Age, y = Estimator, fill = Age)) +
geom_boxplot() +
ggtitle("The result of R-learner(Age)") +
xlab("Age Group") +
ylab("Estimator") +
scale_fill_manual(values = rainbow(length(unique(plotdata$Age))), labels = age_labels) +
theme_bw()
rm(list = ls())
directory <- "~/Desktop"
setwd(paste0(directory))
getwd()
library(knitr)
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(rigr)
library(dplyr)
library(gtsummary)
library(flextable)
library(ggplot2)
library(gridExtra) #combine plot
library(patchwork) #plot combination
data <- read.csv("Diabetes.csv")
data$ageCat <- factor(data$Age, levels = 1:13, labels = c("18-24", "25-29", "30-34", "35-39", "40-44", "45-49", "50-54", "55-59", "60-64", "65-69", "70-74", "75-79", ">=80") )
data$eduCat <- factor(data$Education, levels = 1:6, labels = c("Never attended school or only kindergarten", "Elementary", "Some high school", "High school graduate", "Some college or technical school", "College graduate"))
data$incomeCat <- factor(data$Income, levels = 1:8, labels = c("< $10,000", "[$10,000, $15,000)", "[$15,000, $20,000)", "[$20,000, $25,000)", "[$25,000, $35,000)", "[$35,000, $50,000)", "[$50,000, $75,000)", ">= $75,000"))
data$diaCat <- factor(data$Diabetes_binary, levels = 0:1, labels = c("Healthy", "Prediabetes or diabetes"))
data$scoreCat2 = ifelse(data$scoreCat == "> mean score", 1, 0)
data$scoreCat2 <- as.numeric(data$scoreCat2)
data$Diabetes_binary <- as.numeric(data$Diabetes_binary)
data$gender <- factor(data$Sex, levels = 0:1, labels = c("Female", "Male"))
